<html>
  <head>
    <script
      type="text/javascript"
      src="https://www.gstatic.com/charts/loader.js"
    ></script>
    <script type="text/javascript">
      google.charts.load("current", {
        packages: ["corechart", "bar", "table"],
      });

      fetch(
        "https://script.google.com/macros/s/AKfycbx0U5nL4dCi2HKNnYvOe-2pe9YoN6xvqeq258wDG9vQj6oZfV7lFkUU-0VSqI8ofrDzzw/exec?sheetName=alltarget",
        {
          redirect: "follow",
        }
      )
        .then((response) => response.text())
        .then((result) => {
          sheetData = JSON.parse(result);
          drawTable(sheetData);
        })
        .catch((error) => console.log("error", error));

      function drawTable(chartData) {
        var data = google.visualization.arrayToDataTable(chartData);

        var options = {
          showRowNumber: true,
          width: "80%",
          height: "90%",
        };

        var table = new google.visualization.Table(
          document.getElementById("table_div")
        );

        table.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="table_div" style="margin-top: 40px"></div>
  </body>
</html>
